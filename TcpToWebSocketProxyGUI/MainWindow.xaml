<Window x:Class="TcpToWebSocketProxyGUI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Tunna_2.0" Height="600" Width="900">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header Section -->
        <GroupBox Grid.Row="0" Header="Configuration" Margin="5">
            <StackPanel Orientation="Horizontal">
                <Button x:Name="btnStart" Content="Start Server" Click="BtnStart_Click" Width="100" Margin="5"/>
                <Button x:Name="btnStop" Content="Stop Server" Click="BtnStop_Click" Width="100" Margin="5" IsEnabled="False"/>
                <TextBlock Text="WebSocket URL:" Margin="10,0,0,0" VerticalAlignment="Center"/>
                <TextBox x:Name="txtWebSocketUrl" Text="ws://192.168.181.134/WebsiteDeployment/webSocketProxyMult/main.aspx" 
                        Width="408" Margin="5"/>
                <TextBlock Text="Status:" Margin="10,0,0,0" VerticalAlignment="Center"/>
                <TextBlock x:Name="txtStatus" Text="Stopped" Foreground="Red" Margin="5" VerticalAlignment="Center" FontWeight="Bold"/>
            </StackPanel>
        </GroupBox>

        <!-- Main Content -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Port Mappings -->
            <GroupBox Grid.Column="0" Header="Port Mappings" Margin="5">
                <DockPanel>
                    <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="5">
                        <Button x:Name="btnAddMapping" Content="Add" Click="BtnAddMapping_Click" Width="60" Margin="0,0,5,0"/>
                        <Button x:Name="btnRemoveMapping" Content="Remove" Click="BtnRemoveMapping_Click" Width="60"/>
                    </StackPanel>
                    <DataGrid x:Name="dgPortMappings" AutoGenerateColumns="False" Margin="5">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Listen Port" Binding="{Binding ListenPort}" Width="100"/>
                            <DataGridTextColumn Header="Target IP" Binding="{Binding TargetIp}" Width="150"/>
                            <DataGridTextColumn Header="Target Port" Binding="{Binding TargetPort}" Width="100"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </DockPanel>
            </GroupBox>

            <!-- Connected Clients -->
            <GroupBox Grid.Column="1" Header="Connected Clients" Margin="5">
                <DockPanel>
                    <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="5">
                        <TextBlock Text="Connected: " FontWeight="Bold"/>
                        <TextBlock x:Name="txtConnectedCount" Text="0" FontWeight="Bold" Foreground="Green" Margin="5,0,0,0"/>

                    </StackPanel>
                    <DataGrid x:Name="dgClients" AutoGenerateColumns="False" IsReadOnly="True"
                  SelectionMode="Single" CanUserAddRows="False" CanUserDeleteRows="False"
                  HeadersVisibility="Column" RowHeight="25" Height="193">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="80"/>
                            <DataGridTextColumn Header="Client Address" Binding="{Binding ClientAddress}" Width="100"/>
                            <DataGridTextColumn Header="Target" Binding="{Binding Target}" Width="100"/>
                            <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="70">
                                <DataGridTextColumn.CellStyle>
                                    <Style TargetType="DataGridCell">
                                        <Setter Property="Foreground" Value="{Binding Status, Converter={StaticResource StatusToColorConverter}}"/>
                                    </Style>
                                </DataGridTextColumn.CellStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Connected" Binding="{Binding ConnectionTime, StringFormat='HH:mm:ss'}" Width="70"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </DockPanel>
            </GroupBox>
        </Grid>

        <!-- Log Section -->
        <GroupBox Grid.Row="2" Header="Log" Margin="5,0,5,0" Height="248" VerticalAlignment="Center" Background="#F0F0F0">
            <DockPanel>
                <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="5">
                    <Button x:Name="btnClearLog" Content="Clear Log" Click="BtnClearLog_Click" Width="80"/>

                </StackPanel>
                <RichTextBox x:Name="rtbLog" IsReadOnly="True" VerticalScrollBarVisibility="Auto" Height="200"  Background="DarkGray"/>
            </DockPanel>
        </GroupBox>
    </Grid>
</Window>